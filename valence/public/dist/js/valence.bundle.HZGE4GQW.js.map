{
  "version": 3,
  "sources": ["../../../../../apps/valence/valence/public/js/transaction.js"],
  "sourcesContent": ["erpnext.TransactionController = class TransactionController extends erpnext.TransactionController {\n    make_quality_inspection() {\n\t\tlet data = [];\n\t\tconst fields = [\n\t\t\t{\n\t\t\t\tlabel: \"Items\",\n\t\t\t\tfieldtype: \"Table\",\n\t\t\t\tfieldname: \"items\",\n\t\t\t\tcannot_add_rows: true,\n\t\t\t\tin_place_edit: true,\n\t\t\t\tdata: data,\n\t\t\t\tget_data: () => {\n\t\t\t\t\treturn data;\n\t\t\t\t},\n\t\t\t\tfields: [\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tfieldname: \"docname\",\n\t\t\t\t\t\thidden: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Read Only\",\n\t\t\t\t\t\tfieldname: \"item_code\",\n\t\t\t\t\t\tlabel: __(\"Item Code\"),\n\t\t\t\t\t\tin_list_view: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Read Only\",\n\t\t\t\t\t\tfieldname: \"item_name\",\n\t\t\t\t\t\tlabel: __(\"Item Name\"),\n\t\t\t\t\t\tin_list_view: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Float\",\n\t\t\t\t\t\tfieldname: \"qty\",\n\t\t\t\t\t\tlabel: __(\"Accepted Quantity\"),\n\t\t\t\t\t\tin_list_view: true,\n\t\t\t\t\t\tread_only: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Float\",\n\t\t\t\t\t\tfieldname: \"sample_size\",\n\t\t\t\t\t\tlabel: __(\"Sample Size\"),\n\t\t\t\t\t\treqd: true,\n\t\t\t\t\t\tin_list_view: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tfieldname: \"description\",\n\t\t\t\t\t\tlabel: __(\"Description\"),\n\t\t\t\t\t\thidden: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tfieldname: \"serial_no\",\n\t\t\t\t\t\tlabel: __(\"Serial No\"),\n\t\t\t\t\t\thidden: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tfieldname: \"batch_no\",\n\t\t\t\t\t\tlabel: __(\"Batch No\"),\n\t\t\t\t\t\thidden: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: \"Data\", //Finbyz Changes\n\t\t\t\t\t\tfieldname: \"ref_item\", //Finbyz Changes\n\t\t\t\t\t\tlabel: __(\"Ref Item\"), //Finbyz Changes\n\t\t\t\t\t\thidden: true //Finbyz Changes\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldname:\"concentration\", //Finbyz Changes\n\t\t\t\t\t\tfieldtype:\"Percent\", //Finbyz Changes\n\t\t\t\t\t\tlabel:__(\"Concentration\"), //Finbyz Changes\n\t\t\t\t\t\thidden: true //Finbyz Changes\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldname: \"lot_no\", //Finbyz Changes\n\t\t\t\t\t\tfieldtype: \"Data\", //Finbyz Changes\n\t\t\t\t\t\tlabel: __(\"Lot No\"), //Finbyz Changes\n\t\t\t\t\t\thidden: true //Finbyz Changes\n\t\t\t\t\t},\n                    {\n\t\t\t\t\t\tfieldname: \"ar_no\", //Finbyz Changes\n\t\t\t\t\t\tfieldtype: \"Data\", //Finbyz Changes\n\t\t\t\t\t\tlabel: __(\"AR No\"), //Finbyz Changes\n\t\t\t\t\t\thidden: true //Finbyz Changes\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\tconst me = this;\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Select Items for Quality Inspection\"),\n\t\t\tfields: fields,\n\t\t\tprimary_action: function () {\n\t\t\t\tconst data = dialog.get_values();\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"erpnext.controllers.stock_controller.make_quality_inspections\",\n\t\t\t\t\targs: {\n\t\t\t\t\t\tdoctype: me.frm.doc.doctype,\n\t\t\t\t\t\tdocname: me.frm.doc.name,\n\t\t\t\t\t\titems: data.items\n\t\t\t\t\t},\n\t\t\t\t\tfreeze: true,\n\t\t\t\t\tcallback: function (r) {\n\t\t\t\t\t\tif (r.message.length > 0) {\n\t\t\t\t\t\t\tif (r.message.length === 1) {\n\t\t\t\t\t\t\t\tfrappe.set_route(\"Form\", \"Quality Inspection\", r.message[0]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfrappe.route_options = {\n\t\t\t\t\t\t\t\t\t\"reference_type\": me.frm.doc.doctype,\n\t\t\t\t\t\t\t\t\t\"reference_name\": me.frm.doc.name\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tfrappe.set_route(\"List\", \"Quality Inspection\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tprimary_action_label: __(\"Create\")\n\t\t});\n\n\t\tthis.frm.doc.items.forEach(item => {\n\t\t\tif (this.has_inspection_required(item)) {\n\t\t\t\tlet dialog_items = dialog.fields_dict.items;\n\t\t\t\tdialog_items.df.data.push({\n\t\t\t\t\t\"docname\": item.name,\n\t\t\t\t\t\"item_code\": item.item_code,\n\t\t\t\t\t\"item_name\": item.item_name,\n\t\t\t\t\t\"qty\": item.qty,\n\t\t\t\t\t\"description\": item.description,\n\t\t\t\t\t\"serial_no\": item.serial_no,\n\t\t\t\t\t\"batch_no\": item.batch_no,\n\t\t\t\t\t\"sample_size\": item.sample_quantity,\n\t\t\t\t\t\"ref_item\": item.name, //Finbyz Changes\n\t\t\t\t\t\"concentration\": item.concentration, //Finbyz Changes\n\t\t\t\t\t\"lot_no\": item.lot_no, //Finbyz Changes\n                    \"ar_no\":item.ar_no,\n\t\t\t\t});\n\t\t\t\tdialog_items.grid.refresh();\n\t\t\t}\n\t\t});\n\n\t\tdata = dialog.fields_dict.items.df.data;\n\t\tif (!data.length) {\n\t\t\tfrappe.msgprint(__(\"All items in this document already have a linked Quality Inspection.\"));\n\t\t} else {\n\t\t\tdialog.show();\n\t\t}\n\t}\n\n\t// has_inspection_required(item) {\n\t// \tif (this.frm.doc.doctype === \"Stock Entry\" && this.frm.doc.purpose == \"Manufacture\" ) {\n\t// \t\tif ((item.is_finished_item || item.is_scrap_item) && !item.quality_inspection) {\n\t// \t\t\treturn true;\n\t// \t\t}\n\t// \t} else if (!item.quality_inspection) {\n\t// \t\treturn true;\n\t// \t}\n\t// }\n}"],
  "mappings": "MAAA,QAAQ,sBAAwB,cAAoC,QAAQ,qBAAsB,CAC9F,yBAA0B,CAC5B,IAAIA,EAAO,CAAC,EACNC,EAAS,CACd,CACC,MAAO,QACP,UAAW,QACX,UAAW,QACX,gBAAiB,GACjB,cAAe,GACf,KAAMD,EACN,SAAU,IACFA,EAER,OAAQ,CACP,CACC,UAAW,OACX,UAAW,UACX,OAAQ,EACT,EACA,CACC,UAAW,YACX,UAAW,YACX,MAAO,GAAG,WAAW,EACrB,aAAc,EACf,EACA,CACC,UAAW,YACX,UAAW,YACX,MAAO,GAAG,WAAW,EACrB,aAAc,EACf,EACA,CACC,UAAW,QACX,UAAW,MACX,MAAO,GAAG,mBAAmB,EAC7B,aAAc,GACd,UAAW,EACZ,EACA,CACC,UAAW,QACX,UAAW,cACX,MAAO,GAAG,aAAa,EACvB,KAAM,GACN,aAAc,EACf,EACA,CACC,UAAW,OACX,UAAW,cACX,MAAO,GAAG,aAAa,EACvB,OAAQ,EACT,EACA,CACC,UAAW,OACX,UAAW,YACX,MAAO,GAAG,WAAW,EACrB,OAAQ,EACT,EACA,CACC,UAAW,OACX,UAAW,WACX,MAAO,GAAG,UAAU,EACpB,OAAQ,EACT,EACA,CACC,UAAW,OACX,UAAW,WACX,MAAO,GAAG,UAAU,EACpB,OAAQ,EACT,EACA,CACC,UAAU,gBACV,UAAU,UACV,MAAM,GAAG,eAAe,EACxB,OAAQ,EACT,EACA,CACC,UAAW,SACX,UAAW,OACX,MAAO,GAAG,QAAQ,EAClB,OAAQ,EACT,EACe,CACd,UAAW,QACX,UAAW,OACX,MAAO,GAAG,OAAO,EACjB,OAAQ,EACT,CACD,CACD,CACD,EAEME,EAAK,KACLC,EAAS,IAAI,OAAO,GAAG,OAAO,CACnC,MAAO,GAAG,qCAAqC,EAC/C,OAAQF,EACR,eAAgB,UAAY,CAC3B,IAAMD,EAAOG,EAAO,WAAW,EAC/B,OAAO,KAAK,CACX,OAAQ,gEACR,KAAM,CACL,QAASD,EAAG,IAAI,IAAI,QACpB,QAASA,EAAG,IAAI,IAAI,KACpB,MAAOF,EAAK,KACb,EACA,OAAQ,GACR,SAAU,SAAUI,EAAG,CAClBA,EAAE,QAAQ,OAAS,IAClBA,EAAE,QAAQ,SAAW,EACxB,OAAO,UAAU,OAAQ,qBAAsBA,EAAE,QAAQ,EAAE,GAE3D,OAAO,cAAgB,CACtB,eAAkBF,EAAG,IAAI,IAAI,QAC7B,eAAkBA,EAAG,IAAI,IAAI,IAC9B,EACA,OAAO,UAAU,OAAQ,oBAAoB,IAG/CC,EAAO,KAAK,CACb,CACD,CAAC,CACF,EACA,qBAAsB,GAAG,QAAQ,CAClC,CAAC,EAED,KAAK,IAAI,IAAI,MAAM,QAAQE,GAAQ,CAClC,GAAI,KAAK,wBAAwBA,CAAI,EAAG,CACvC,IAAIC,EAAeH,EAAO,YAAY,MACtCG,EAAa,GAAG,KAAK,KAAK,CACzB,QAAWD,EAAK,KAChB,UAAaA,EAAK,UAClB,UAAaA,EAAK,UAClB,IAAOA,EAAK,IACZ,YAAeA,EAAK,YACpB,UAAaA,EAAK,UAClB,SAAYA,EAAK,SACjB,YAAeA,EAAK,gBACpB,SAAYA,EAAK,KACjB,cAAiBA,EAAK,cACtB,OAAUA,EAAK,OACA,MAAQA,EAAK,KAC7B,CAAC,EACDC,EAAa,KAAK,QAAQ,CAC3B,CACD,CAAC,EAEDN,EAAOG,EAAO,YAAY,MAAM,GAAG,KAC9BH,EAAK,OAGTG,EAAO,KAAK,EAFZ,OAAO,SAAS,GAAG,sEAAsE,CAAC,CAI5F,CAWD",
  "names": ["data", "fields", "me", "dialog", "r", "item", "dialog_items"]
}
